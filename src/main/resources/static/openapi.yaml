openapi: 3.0.3
info:
  title: FIS Process API
  version: v1
  description: Complete REST API contract for the FIS ledger service.
servers:
  - url: /v1
security:
  - bearerAuth: []
paths:
  /events:
    post:
      summary: Ingest financial event
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - $ref: '#/components/parameters/SourceSystemHeader'
        - $ref: '#/components/parameters/TraceparentHeader'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FinancialEventRequest'
      responses:
        '202':
          description: Accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventIngestionResponse'
        '400':
          $ref: '#/components/responses/ValidationFailed'
        '409':
          $ref: '#/components/responses/DuplicateIdempotencyKey'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'

  /journal-entries:
    post:
      summary: Create manual journal entry
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - $ref: '#/components/parameters/ActorRoleHeader'
        - $ref: '#/components/parameters/TraceparentHeader'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateJournalEntryRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JournalEntryResponse'
        '400':
          $ref: '#/components/responses/ValidationFailed'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'

    get:
      summary: List journal entries
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: postedDateFrom
          in: query
          schema:
            type: string
            format: date
        - name: postedDateTo
          in: query
          schema:
            type: string
            format: date
        - name: accountCode
          in: query
          schema:
            type: string
        - name: status
          in: query
          schema:
            type: string
            enum: [DRAFT, PENDING_APPROVAL, POSTED, REVERSAL, CORRECTION, REJECTED]
        - name: referenceId
          in: query
          schema:
            type: string
        - name: page
          in: query
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: Journal entries page
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JournalEntryPage'

  /journal-entries/batch:
    post:
      summary: Create manual journal entries in batch
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - $ref: '#/components/parameters/ActorRoleHeader'
        - $ref: '#/components/parameters/TraceparentHeader'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateJournalEntryBatchRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JournalEntryBatchResponse'
        '400':
          $ref: '#/components/responses/ValidationFailed'
        '409':
          $ref: '#/components/responses/DuplicateIdempotencyKey'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'

  /journal-entries/{id}:
    get:
      summary: Get journal entry by id
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Journal entry
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JournalEntryResponse'
        '404':
          $ref: '#/components/responses/NotFound'

  /journal-entries/{id}/reverse:
    post:
      summary: Reverse posted journal entry
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReversalRequest'
      responses:
        '201':
          description: Reversal posted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReversalResponse'
        '409':
          $ref: '#/components/responses/InvalidReversal'

  /journal-entries/{id}/correct:
    post:
      summary: Correct posted journal entry (reverse + replacement)
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CorrectionRequest'
      responses:
        '201':
          description: Correction completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReversalResponse'
        '409':
          $ref: '#/components/responses/InvalidReversal'

  /journal-entries/{id}/submit:
    post:
      summary: Submit draft journal entry for approval
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubmitWorkflowRequest'
      responses:
        '200':
          description: Workflow submitted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JournalWorkflowActionResponse'

  /journal-entries/{id}/approve:
    post:
      summary: Approve pending workflow journal entry
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - $ref: '#/components/parameters/ActorRoleHeader'
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApproveWorkflowRequest'
      responses:
        '201':
          description: Workflow approved and posted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JournalWorkflowActionResponse'

  /journal-entries/{id}/reject:
    post:
      summary: Reject pending workflow journal entry
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RejectWorkflowRequest'
      responses:
        '200':
          description: Workflow rejected
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JournalWorkflowActionResponse'

  /accounts:
    post:
      summary: Create account
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - $ref: '#/components/parameters/ActorIdHeader'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAccountRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
    get:
      summary: List accounts
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: accountType
          in: query
          schema:
            type: string
            enum: [ASSET, LIABILITY, EQUITY, REVENUE, EXPENSE]
        - name: isActive
          in: query
          schema:
            type: boolean
      responses:
        '200':
          description: Account page
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountPage'

  /accounts/{accountCode}:
    get:
      summary: Get account by code
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: accountCode
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Account
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        '404':
          $ref: '#/components/responses/NotFound'
    patch:
      summary: Update account
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - $ref: '#/components/parameters/ActorIdHeader'
        - name: accountCode
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAccountRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'

  /accounts/{accountCode}/aggregated-balance:
    get:
      summary: Get account aggregated balance (self + descendants)
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: accountCode
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Account with aggregated balance
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        '404':
          $ref: '#/components/responses/NotFound'

  /accounting-periods:
    post:
      summary: Create accounting period
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAccountingPeriodRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountingPeriodResponse'
    get:
      summary: List accounting periods
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: status
          in: query
          schema:
            type: string
            enum: [OPEN, SOFT_CLOSED, HARD_CLOSED]
      responses:
        '200':
          description: Accounting period list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AccountingPeriodResponse'

  /accounting-periods/{periodId}/status:
    patch:
      summary: Change accounting period status
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - $ref: '#/components/parameters/ActorIdHeader'
        - name: periodId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PeriodStatusChangeRequest'
      responses:
        '200':
          description: Updated period
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountingPeriodResponse'

  /exchange-rates:
    post:
      summary: Upload exchange rates
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExchangeRateUploadRequest'
      responses:
        '201':
          description: Uploaded rates
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ExchangeRateResponse'
    get:
      summary: Query exchange rates
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: sourceCurrency
          in: query
          required: true
          schema:
            type: string
        - name: targetCurrency
          in: query
          required: true
          schema:
            type: string
        - name: effectiveDate
          in: query
          required: false
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Matching rates
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ExchangeRateResponse'

  /mapping-rules:
    post:
      summary: Create mapping rule
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateMappingRuleRequest'
      responses:
        '201':
          description: Created mapping rule
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MappingRuleResponse'
    get:
      summary: List mapping rules
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: eventType
          in: query
          required: false
          schema:
            type: string
        - name: isActive
          in: query
          required: false
          schema:
            type: boolean
        - name: page
          in: query
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: Mapping rule page
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MappingRulePage'

  /mapping-rules/{id}:
    put:
      summary: Update mapping rule
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateMappingRuleRequest'
      responses:
        '200':
          description: Updated mapping rule
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MappingRuleResponse'
    delete:
      summary: Deactivate mapping rule
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - $ref: '#/components/parameters/ActorIdHeader'
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Deactivated

  /revaluations/periods/{periodId}:
    post:
      summary: Run period-end revaluation
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: periodId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RunRevaluationRequest'
      responses:
        '201':
          description: Revaluation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RevaluationResponse'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'

  /revaluations/periods/{periodId}/translation:
    post:
      summary: Run functional-currency translation (CTA/OCI) for income statement items
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: periodId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RunTranslationRequest'
      responses:
        '201':
          description: Translation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TranslationResponse'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'

  /settlements:
    post:
      summary: Record FX settlement and post realized gain/loss adjustment
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SettlementRequest'
      responses:
        '201':
          description: Settlement processed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SettlementResponse'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'

  /admin/integrity-check:
    get:
      summary: Verify accounting equation integrity for a tenant
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
      responses:
        '200':
          description: Integrity check result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LedgerIntegrityCheckResponse'

  /admin/year-end-close:
    post:
      summary: Perform fiscal year-end close
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/YearEndCloseRequest'
      responses:
        '200':
          description: Year-end close result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/YearEndCloseResponse'
        '400':
          $ref: '#/components/responses/ValidationFailed'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'

  /reports/trial-balance:
    get:
      summary: Generate trial balance report
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: asOfDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Trial balance report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TrialBalanceReport'

  /reports/balance-sheet:
    get:
      summary: Generate balance sheet report
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: asOfDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Balance sheet report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BalanceSheetReport'

  /reports/income-statement:
    get:
      summary: Generate income statement report
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: fromDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: toDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Income statement report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IncomeStatementReport'

  /reports/general-ledger/{accountCode}:
    get:
      summary: Generate general ledger detail report
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: accountCode
          in: path
          required: true
          schema:
            type: string
        - name: fromDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: toDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: General ledger report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GeneralLedgerReport'

  /reports/cash-flow:
    get:
      summary: Generate cash flow report
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: fromDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: toDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Cash flow report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CashFlowReport'

  /reports/account-activity/{accountCode}:
    get:
      summary: Generate account activity report
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: accountCode
          in: path
          required: true
          schema:
            type: string
        - name: fromDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: toDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Account activity report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountActivityReport'

  /reports/journal-register:
    get:
      summary: Generate journal register report
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: fromDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: toDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          required: false
          schema:
            type: integer
            default: 50
      responses:
        '200':
          description: Journal register report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JournalRegisterReport'

  /reports/dimension-summary:
    get:
      summary: Generate dimension summary report
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: dimensionKey
          in: query
          required: true
          schema:
            type: string
        - name: fromDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: toDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Dimension summary report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DimensionSummaryReport'

  /reports/fx-exposure:
    get:
      summary: Generate FX exposure report
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: asOfDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: FX exposure report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FxExposureReport'

  /reports/aging:
    get:
      summary: Generate aging analysis report
      parameters:
        - $ref: '#/components/parameters/TenantHeader'
        - name: accountType
          in: query
          required: true
          schema:
            type: string
            enum: [ASSET, LIABILITY]
        - name: asOfDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Aging report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgingReport'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  parameters:
    TenantHeader:
      name: X-Tenant-Id
      in: header
      required: true
      schema:
        type: string
        format: uuid
    SourceSystemHeader:
      name: X-Source-System
      in: header
      required: true
      schema:
        type: string
    ActorRoleHeader:
      name: X-Actor-Role
      in: header
      required: false
      schema:
        type: string
    ActorIdHeader:
      name: X-Actor-Id
      in: header
      required: false
      schema:
        type: string
    TraceparentHeader:
      name: traceparent
      in: header
      required: false
      schema:
        type: string

  responses:
    ValidationFailed:
      description: Validation failed
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
    NotFound:
      description: Entity not found
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
    DuplicateIdempotencyKey:
      description: Duplicate idempotency key with conflicting payload
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
    InvalidReversal:
      description: Reversal is invalid
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
    UnprocessableEntity:
      description: Business rule rejection
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
    RateLimitExceeded:
      description: Too many requests for protected posting endpoints
      headers:
        Retry-After:
          schema:
            type: integer
          description: Retry window in seconds
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'

  schemas:
    Problem:
      type: object
      properties:
        type:
          type: string
        title:
          type: string
        status:
          type: integer
        detail:
          type: string
        instance:
          type: string

    JournalLineRequest:
      type: object
      required: [accountCode, amountCents, isCredit]
      properties:
        accountCode:
          type: string
        amountCents:
          type: integer
          format: int64
        isCredit:
          type: boolean
        dimensions:
          type: object
          additionalProperties:
            type: string

    CreateJournalEntryRequest:
      type: object
      required: [eventId, postedDate, transactionCurrency, createdBy, lines]
      properties:
        eventId:
          type: string
        postedDate:
          type: string
          format: date
        effectiveDate:
          type: string
          format: date
          nullable: true
        transactionDate:
          type: string
          format: date
          nullable: true
        description:
          type: string
          nullable: true
        referenceId:
          type: string
          nullable: true
        transactionCurrency:
          type: string
        createdBy:
          type: string
        autoReverse:
          type: boolean
          default: false
        lines:
          type: array
          items:
            $ref: '#/components/schemas/JournalLineRequest'

    CreateJournalEntryBatchRequest:
      type: object
      required: [batchMode, entries]
      properties:
        batchMode:
          $ref: '#/components/schemas/JournalBatchMode'
        entries:
          type: array
          minItems: 1
          items:
            $ref: '#/components/schemas/CreateJournalEntryRequest'

    JournalBatchMode:
      type: string
      enum: [POST_NOW, CREATE_DRAFTS]

    JournalEntryResponse:
      type: object
      properties:
        journalEntryId:
          type: string
          format: uuid
        postedDate:
          type: string
          format: date
        effectiveDate:
          type: string
          format: date
        transactionDate:
          type: string
          format: date
        status:
          type: string
        description:
          type: string
          nullable: true
        referenceId:
          type: string
          nullable: true
        transactionCurrency:
          type: string
        baseCurrency:
          type: string
        exchangeRate:
          type: number
        lineCount:
          type: integer
        reversalOfId:
          type: string
          format: uuid
          nullable: true
        createdBy:
          type: string
        createdAt:
          type: string
          format: date-time
        fiscalYear:
          type: integer
          nullable: true
        sequenceNumber:
          type: integer
          format: int64
          nullable: true

    JournalEntryBatchResponse:
      type: object
      properties:
        batchMode:
          $ref: '#/components/schemas/JournalBatchMode'
        count:
          type: integer
        entries:
          type: array
          items:
            $ref: '#/components/schemas/JournalEntryResponse'

    JournalEntryPage:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/JournalEntryResponse'
        totalElements:
          type: integer
        totalPages:
          type: integer
        size:
          type: integer
        number:
          type: integer

    ReversalRequest:
      type: object
      required: [eventId, reason, createdBy]
      properties:
        eventId:
          type: string
        reason:
          type: string
        createdBy:
          type: string

    CorrectionRequest:
      type: object
      required: [eventId, reversalEventId, postedDate, transactionCurrency, createdBy, lines]
      properties:
        eventId:
          type: string
        reversalEventId:
          type: string
        postedDate:
          type: string
          format: date
        description:
          type: string
          nullable: true
        referenceId:
          type: string
          nullable: true
        transactionCurrency:
          type: string
        createdBy:
          type: string
        lines:
          type: array
          items:
            $ref: '#/components/schemas/JournalLineRequest'

    ReversalResponse:
      type: object
      properties:
        reversalJournalEntryId:
          type: string
          format: uuid
        originalJournalEntryId:
          type: string
          format: uuid
        status:
          type: string
        message:
          type: string

    SubmitWorkflowRequest:
      type: object
      required: [submittedBy]
      properties:
        submittedBy:
          type: string

    ApproveWorkflowRequest:
      type: object
      required: [approvedBy]
      properties:
        approvedBy:
          type: string

    RejectWorkflowRequest:
      type: object
      required: [rejectedBy, reason]
      properties:
        rejectedBy:
          type: string
        reason:
          type: string

    JournalWorkflowActionResponse:
      type: object
      properties:
        workflowId:
          type: string
          format: uuid
        status:
          type: string
          enum: [DRAFT, PENDING_APPROVAL, APPROVED, REJECTED]
        postedJournalEntryId:
          type: string
          format: uuid
          nullable: true
        message:
          type: string

    CreateAccountRequest:
      type: object
      required: [code, name, accountType, currencyCode]
      properties:
        code:
          type: string
        name:
          type: string
        accountType:
          type: string
          enum: [ASSET, LIABILITY, EQUITY, REVENUE, EXPENSE]
        currencyCode:
          type: string
        parentAccountCode:
          type: string
          nullable: true
        contra:
          type: boolean

    UpdateAccountRequest:
      type: object
      properties:
        name:
          type: string
          nullable: true
        isActive:
          type: boolean
          nullable: true

    AccountResponse:
      type: object
      properties:
        accountId:
          type: string
          format: uuid
        code:
          type: string
        name:
          type: string
        accountType:
          type: string
        currencyCode:
          type: string
        currentBalanceCents:
          type: integer
          format: int64
        formattedBalance:
          type: string
        isActive:
          type: boolean
        contra:
          type: boolean
        parentAccountCode:
          type: string
          nullable: true
        aggregatedBalanceCents:
          type: integer
          format: int64
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    AccountPage:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/AccountResponse'
        totalElements:
          type: integer
        totalPages:
          type: integer
        size:
          type: integer
        number:
          type: integer

    CreateAccountingPeriodRequest:
      type: object
      required: [name, startDate, endDate]
      properties:
        name:
          type: string
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date

    PeriodStatusChangeRequest:
      type: object
      required: [status]
      properties:
        status:
          type: string
          enum: [OPEN, SOFT_CLOSED, HARD_CLOSED]

    AccountingPeriodResponse:
      type: object
      properties:
        periodId:
          type: string
          format: uuid
        name:
          type: string
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        status:
          type: string
        closedBy:
          type: string
          nullable: true
        closedAt:
          type: string
          format: date-time
          nullable: true

    ExchangeRateEntry:
      type: object
      required: [sourceCurrency, targetCurrency, rate, effectiveDate]
      properties:
        sourceCurrency:
          type: string
        targetCurrency:
          type: string
        rate:
          type: number
        effectiveDate:
          type: string
          format: date

    ExchangeRateUploadRequest:
      type: object
      required: [rates]
      properties:
        rates:
          type: array
          items:
            $ref: '#/components/schemas/ExchangeRateEntry'

    ExchangeRateResponse:
      type: object
      properties:
        rateId:
          type: string
          format: uuid
        sourceCurrency:
          type: string
        targetCurrency:
          type: string
        rate:
          type: number
        effectiveDate:
          type: string
          format: date

    MappingRuleLine:
      type: object
      required: [accountCodeExpression, amountExpression]
      properties:
        accountCodeExpression:
          type: string
        isCredit:
          type: boolean
        amountExpression:
          type: string
        sortOrder:
          type: integer

    CreateMappingRuleRequest:
      type: object
      required: [eventType, createdBy, lines]
      properties:
        eventType:
          type: string
        description:
          type: string
          nullable: true
        createdBy:
          type: string
        lines:
          type: array
          items:
            $ref: '#/components/schemas/MappingRuleLine'

    UpdateMappingRuleRequest:
      type: object
      required: [eventType, updatedBy, lines]
      properties:
        eventType:
          type: string
        description:
          type: string
          nullable: true
        updatedBy:
          type: string
        lines:
          type: array
          items:
            $ref: '#/components/schemas/MappingRuleLine'

    MappingRuleResponse:
      type: object
      properties:
        ruleId:
          type: string
          format: uuid
        eventType:
          type: string
        description:
          type: string
          nullable: true
        isActive:
          type: boolean
        version:
          type: integer
        createdBy:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        lines:
          type: array
          items:
            $ref: '#/components/schemas/MappingRuleLine'

    MappingRulePage:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/MappingRuleResponse'
        totalElements:
          type: integer
        totalPages:
          type: integer
        size:
          type: integer
        number:
          type: integer

    FinancialEventRequest:
      type: object
      required: [eventId, eventType, occurredAt, postedDate, transactionCurrency, createdBy]
      properties:
        eventId:
          type: string
        eventType:
          type: string
        occurredAt:
          type: string
          format: date-time
        postedDate:
          type: string
          format: date
        description:
          type: string
          nullable: true
        referenceId:
          type: string
          nullable: true
        transactionCurrency:
          type: string
        createdBy:
          type: string
        lines:
          type: array
          items:
            $ref: '#/components/schemas/JournalLineRequest'
        payload:
          type: object
          additionalProperties: true

    EventIngestionResponse:
      type: object
      properties:
        status:
          type: string
        ik:
          type: string
        message:
          type: string

    RunRevaluationRequest:
      type: object
      required: [eventId, createdBy, reserveAccountCode, gainAccountCode, lossAccountCode]
      properties:
        eventId:
          type: string
        createdBy:
          type: string
        reserveAccountCode:
          type: string
        gainAccountCode:
          type: string
        lossAccountCode:
          type: string

    RunTranslationRequest:
      type: object
      required: [eventId, createdBy, ctaOciAccountCode, translationReserveAccountCode]
      properties:
        eventId:
          type: string
        createdBy:
          type: string
        ctaOciAccountCode:
          type: string
        translationReserveAccountCode:
          type: string

    RevaluationResponse:
      type: object
      properties:
        periodId:
          type: string
          format: uuid
        runId:
          type: string
          format: uuid
        status:
          type: string
        generatedJournalEntryIds:
          type: array
          items:
            type: string
            format: uuid

    TranslationResponse:
      type: object
      properties:
        periodId:
          type: string
          format: uuid
        runId:
          type: string
          format: uuid
        status:
          type: string
        generatedJournalEntryIds:
          type: array
          items:
            type: string
            format: uuid

    SettlementRequest:
      type: object
      required:
        [eventId, originalJournalEntryId, settlementDate, settlementRate, monetaryAccountCode, gainAccountCode, lossAccountCode, createdBy]
      properties:
        eventId:
          type: string
        originalJournalEntryId:
          type: string
          format: uuid
        settlementDate:
          type: string
          format: date
        settlementRate:
          type: number
        monetaryAccountCode:
          type: string
        gainAccountCode:
          type: string
        lossAccountCode:
          type: string
        createdBy:
          type: string

    SettlementResponse:
      type: object
      properties:
        originalJournalEntryId:
          type: string
          format: uuid
        realizedGainLossJournalEntryId:
          type: string
          format: uuid
          nullable: true
        realizedDeltaBaseCents:
          type: integer
          format: int64
        message:
          type: string

    LedgerIntegrityCheckResponse:
      type: object
      properties:
        tenantId:
          type: string
          format: uuid
        assetTotal:
          type: integer
          format: int64
        liabilityTotal:
          type: integer
          format: int64
        equityTotal:
          type: integer
          format: int64
        revenueTotal:
          type: integer
          format: int64
        expenseTotal:
          type: integer
          format: int64
        equationDelta:
          type: integer
          format: int64
        balanced:
          type: boolean

    YearEndCloseRequest:
      type: object
      required: [fiscalYear, retainedEarningsAccountCode, createdBy]
      properties:
        fiscalYear:
          type: integer
        retainedEarningsAccountCode:
          type: string
        createdBy:
          type: string

    YearEndCloseResponse:
      type: object
      properties:
        fiscalYear:
          type: integer
        closingJournalEntryId:
          type: string
          format: uuid
          nullable: true
        totalRevenue:
          type: integer
          format: int64
        totalExpenses:
          type: integer
          format: int64
        netIncome:
          type: integer
          format: int64
        accountsClosed:
          type: integer
        retainedEarningsAccountCode:
          type: string
        message:
          type: string

    ReportMetadata:
      type: object
      properties:
        reportType:
          type: string
        tenantId:
          type: string
          format: uuid
        asOfDate:
          type: string
          format: date
          nullable: true
        fromDate:
          type: string
          format: date
          nullable: true
        toDate:
          type: string
          format: date
          nullable: true
        baseCurrency:
          type: string
        generatedAt:
          type: string
          format: date-time

    TrialBalanceLine:
      type: object
      properties:
        accountCode:
          type: string
        accountName:
          type: string
        accountType:
          type: string
        parentAccountCode:
          type: string
          nullable: true
        hierarchyLevel:
          type: integer
          format: int32
        leaf:
          type: boolean
        debitBalance:
          type: integer
          format: int64
        creditBalance:
          type: integer
          format: int64
        rolledUpDebitBalance:
          type: integer
          format: int64
        rolledUpCreditBalance:
          type: integer
          format: int64

    TrialBalanceReport:
      type: object
      properties:
        metadata:
          $ref: '#/components/schemas/ReportMetadata'
        lines:
          type: array
          items:
            $ref: '#/components/schemas/TrialBalanceLine'
        totalDebits:
          type: integer
          format: int64
        totalCredits:
          type: integer
          format: int64
        balanced:
          type: boolean

    BalanceSheetLine:
      type: object
      properties:
        accountCode:
          type: string
        accountName:
          type: string
        parentAccountCode:
          type: string
          nullable: true
        hierarchyLevel:
          type: integer
          format: int32
        leaf:
          type: boolean
        balanceCents:
          type: integer
          format: int64
        rolledUpBalanceCents:
          type: integer
          format: int64
        formattedBalance:
          type: string
        formattedRolledUpBalance:
          type: string

    BalanceSheetSection:
      type: object
      properties:
        sectionName:
          type: string
        lines:
          type: array
          items:
            $ref: '#/components/schemas/BalanceSheetLine'
        sectionTotal:
          type: integer
          format: int64

    BalanceSheetReport:
      type: object
      properties:
        metadata:
          $ref: '#/components/schemas/ReportMetadata'
        assets:
          $ref: '#/components/schemas/BalanceSheetSection'
        liabilities:
          $ref: '#/components/schemas/BalanceSheetSection'
        equity:
          $ref: '#/components/schemas/BalanceSheetSection'
        totalAssets:
          type: integer
          format: int64
        totalLiabilitiesAndEquity:
          type: integer
          format: int64
        balanced:
          type: boolean

    IncomeStatementLine:
      type: object
      properties:
        accountCode:
          type: string
        accountName:
          type: string
        parentAccountCode:
          type: string
          nullable: true
        hierarchyLevel:
          type: integer
          format: int32
        leaf:
          type: boolean
        amountCents:
          type: integer
          format: int64
        rolledUpAmountCents:
          type: integer
          format: int64
        formattedAmount:
          type: string
        formattedRolledUpAmount:
          type: string

    IncomeStatementSection:
      type: object
      properties:
        sectionName:
          type: string
        lines:
          type: array
          items:
            $ref: '#/components/schemas/IncomeStatementLine'
        sectionTotal:
          type: integer
          format: int64

    IncomeStatementReport:
      type: object
      properties:
        metadata:
          $ref: '#/components/schemas/ReportMetadata'
        revenue:
          $ref: '#/components/schemas/IncomeStatementSection'
        expenses:
          $ref: '#/components/schemas/IncomeStatementSection'
        totalRevenue:
          type: integer
          format: int64
        totalExpenses:
          type: integer
          format: int64
        netIncome:
          type: integer
          format: int64

    GeneralLedgerEntry:
      type: object
      properties:
        journalEntryId:
          type: string
          format: uuid
        sequenceNumber:
          type: integer
          format: int64
          nullable: true
        postedDate:
          type: string
          format: date
        description:
          type: string
        debitAmount:
          type: integer
          format: int64
        creditAmount:
          type: integer
          format: int64
        runningBalance:
          type: integer
          format: int64

    GeneralLedgerReport:
      type: object
      properties:
        metadata:
          $ref: '#/components/schemas/ReportMetadata'
        accountCode:
          type: string
        accountName:
          type: string
        openingBalance:
          type: integer
          format: int64
        entries:
          type: array
          items:
            $ref: '#/components/schemas/GeneralLedgerEntry'
        closingBalance:
          type: integer
          format: int64

    CashFlowLine:
      type: object
      properties:
        label:
          type: string
        amountCents:
          type: integer
          format: int64

    CashFlowSection:
      type: object
      properties:
        sectionName:
          type: string
        lines:
          type: array
          items:
            $ref: '#/components/schemas/CashFlowLine'
        sectionTotal:
          type: integer
          format: int64

    CashFlowReport:
      type: object
      properties:
        metadata:
          $ref: '#/components/schemas/ReportMetadata'
        operatingActivities:
          $ref: '#/components/schemas/CashFlowSection'
        investingActivities:
          $ref: '#/components/schemas/CashFlowSection'
        financingActivities:
          $ref: '#/components/schemas/CashFlowSection'
        netCashChange:
          type: integer
          format: int64
        openingCash:
          type: integer
          format: int64
        closingCash:
          type: integer
          format: int64

    AccountActivityReport:
      type: object
      properties:
        metadata:
          $ref: '#/components/schemas/ReportMetadata'
        accountCode:
          type: string
        accountName:
          type: string
        openingBalance:
          type: integer
          format: int64
        totalDebits:
          type: integer
          format: int64
        totalCredits:
          type: integer
          format: int64
        closingBalance:
          type: integer
          format: int64
        transactionCount:
          type: integer
          format: int64

    JournalRegisterEntry:
      type: object
      properties:
        journalEntryId:
          type: string
          format: uuid
        sequenceNumber:
          type: integer
          format: int64
          nullable: true
        postedDate:
          type: string
          format: date
        description:
          type: string
        status:
          type: string
        totalDebits:
          type: integer
          format: int64
        totalCredits:
          type: integer
          format: int64
        createdBy:
          type: string

    JournalRegisterReport:
      type: object
      properties:
        metadata:
          $ref: '#/components/schemas/ReportMetadata'
        entries:
          type: array
          items:
            $ref: '#/components/schemas/JournalRegisterEntry'
        totalEntries:
          type: integer
          format: int64
        page:
          type: integer
        size:
          type: integer
        totalPages:
          type: integer
          format: int64

    DimensionSummaryLine:
      type: object
      properties:
        dimensionValue:
          type: string
        debitTotal:
          type: integer
          format: int64
        creditTotal:
          type: integer
          format: int64
        netAmount:
          type: integer
          format: int64

    DimensionSummaryReport:
      type: object
      properties:
        metadata:
          $ref: '#/components/schemas/ReportMetadata'
        dimensionKey:
          type: string
        lines:
          type: array
          items:
            $ref: '#/components/schemas/DimensionSummaryLine'
        grandTotal:
          type: integer
          format: int64

    FxExposureLine:
      type: object
      properties:
        currency:
          type: string
        assetExposure:
          type: integer
          format: int64
        liabilityExposure:
          type: integer
          format: int64
        netExposure:
          type: integer
          format: int64
        currentRate:
          type: number
        unrealizedGainLoss:
          type: integer
          format: int64

    FxExposureReport:
      type: object
      properties:
        metadata:
          $ref: '#/components/schemas/ReportMetadata'
        baseCurrency:
          type: string
        exposures:
          type: array
          items:
            $ref: '#/components/schemas/FxExposureLine'
        totalUnrealizedGainLoss:
          type: integer
          format: int64

    AgingBucket:
      type: object
      properties:
        bucketLabel:
          type: string
        amountCents:
          type: integer
          format: int64
        entryCount:
          type: integer
          format: int64

    AgingReport:
      type: object
      properties:
        metadata:
          $ref: '#/components/schemas/ReportMetadata'
        accountType:
          type: string
        buckets:
          type: array
          items:
            $ref: '#/components/schemas/AgingBucket'
        grandTotal:
          type: integer
          format: int64
